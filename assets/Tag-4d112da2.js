import{l as F,m as L,n as j,p as K,q as V,d as w,c as t,a as i,b as f,t as R,u as a,s as y,x as B,F as E,o as v,L as W,_ as A}from"./index-5772a8e4.js";const I=({organization:d,repository:c,tag:o,enabled:r})=>F({queryKey:["PrFromRefTag",d,c,o],refetchOnWindowFocus:!1,enabled:r,queryFn:async({queryKey:[,e,n,h]})=>await L({organization:e,repository:n,tag:h}).then(({object:{sha:m}})=>j({organization:e,repository:n,tag:m}).then(_=>K({organization:e,repository:n,commit:_.object.sha}))).then(({items:[m]})=>m)}),S=({organization:d,repository:c,pullRequestNumber:o,enabled:r})=>F({queryKey:["CommentsFromPullRequest",d,c,o],enabled:r,queryFn:async({queryKey:[,e,n,h]})=>await V({organization:e,repository:n,pullRequestNumber:h})}),D=["href"],O=["href"],Q=["href"],Z={key:0},G={key:1},H={key:2},J=w({__name:"Tag",props:["organization","repository","tag"],setup(d){const c=d,o=t(()=>c.organization),r=t(()=>c.repository),e=t(()=>c.tag),n=t(()=>u.value?u==null?void 0:u.value.html_url:null),h=t(()=>{var s,l;return(s=u.value)!=null&&s.body?(l=u.value)==null?void 0:l.body.match(/([A-Z]+-\d+)/g):null}),m=t(()=>{var b,T;if(!((b=u.value)!=null&&b.body))return null;const s=/Changes in this PR:\r\n\r\n([\s\S]*?)(?=âœ‚|$)/,l=(T=u.value)==null?void 0:T.body.match(s);return l&&l[1]||""}),_=t(()=>g.value&&n.value?n.value:""),$=t(()=>`- ${e.value} ${h.value?`- ${h.value.join(", ")}`:""} (${_.value})
${m?`    ${m.value}`:""}${p.value?`- Test Report: ${p.value}`:""}`),q=t(()=>o.value&&r.value&&e.value?`https://github.com/${o.value}/${r.value}/releases/tag/${e.value}`:null),g=t(()=>u.value?`${u.value.number}`:null),{data:u,isLoading:k,isFetching:C,isError:z,error:P}=I({organization:o.value,repository:r.value,tag:e.value,enabled:!!o.value&&!!r.value&&!!e.value}),x=t(()=>!!o.value&&!!r.value&&!!g.value),{data:N}=S({organization:o.value,repository:r.value,pullRequestNumber:g.value,enabled:x.value&&!!g.value}),p=t(()=>{const s=N.value;if(!s||(s==null?void 0:s.length)==0)return"";const l=s.at(-1).body.match(/Allure report: (.*)/);return l?l[1]:""});return(s,l)=>(v(),i(E,null,[f("header",null,[f("h1",null,R(a(e)),1),f("nav",null,[a(q)?(v(),i("a",{key:0,href:a(q)},"Version",8,D)):y("",!0),a(n)?(v(),i("a",{key:1,href:a(n)},"Pull Request",8,O)):y("",!0),a(p)?(v(),i("a",{key:2,href:a(p)},"Test Report",8,Q)):y("",!0)])]),a(k)||a(C)?(v(),i("div",Z,[B(W)])):(v(),i("pre",G,R(a($)||""),1)),a(z)?(v(),i("div",H,"Error: "+R(a(P)),1)):y("",!0)],64))}});const U=A(J,[["__scopeId","data-v-dfd05afa"]]);export{U as T};
